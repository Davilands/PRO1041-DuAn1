USE [master]
GO
-- drop database DAVISY
/****** Object:  Database [DAVISY]    Script Date: 11/18/2022 8:52:05 AM ******/
CREATE DATABASE [DAVISY]
-- use DAVISY
 CONTAINMENT = NONE
 ON  PRIMARY 
( NAME = N'DAVISY', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL15.MSSQLSERVER\MSSQL\DATA\DAVISY.mdf' , SIZE = 8192KB , MAXSIZE = UNLIMITED, FILEGROWTH = 65536KB )
 LOG ON 
( NAME = N'DAVISY_log', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL15.MSSQLSERVER\MSSQL\DATA\DAVISY_log.ldf' , SIZE = 8192KB , MAXSIZE = 2048GB , FILEGROWTH = 65536KB )
 WITH CATALOG_COLLATION = DATABASE_DEFAULT
GO
ALTER DATABASE [DAVISY] SET COMPATIBILITY_LEVEL = 150
GO
IF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))
begin
EXEC [DAVISY].[dbo].[sp_fulltext_database] @action = 'enable'
end
GO
ALTER DATABASE [DAVISY] SET ANSI_NULL_DEFAULT OFF 
GO
ALTER DATABASE [DAVISY] SET ANSI_NULLS OFF 
GO
ALTER DATABASE [DAVISY] SET ANSI_PADDING OFF 
GO
ALTER DATABASE [DAVISY] SET ANSI_WARNINGS OFF 
GO
ALTER DATABASE [DAVISY] SET ARITHABORT OFF 
GO
ALTER DATABASE [DAVISY] SET AUTO_CLOSE ON 
GO
ALTER DATABASE [DAVISY] SET AUTO_SHRINK OFF 
GO
ALTER DATABASE [DAVISY] SET AUTO_UPDATE_STATISTICS ON 
GO
ALTER DATABASE [DAVISY] SET CURSOR_CLOSE_ON_COMMIT OFF 
GO
ALTER DATABASE [DAVISY] SET CURSOR_DEFAULT  GLOBAL 
GO
ALTER DATABASE [DAVISY] SET CONCAT_NULL_YIELDS_NULL OFF 
GO
ALTER DATABASE [DAVISY] SET NUMERIC_ROUNDABORT OFF 
GO
ALTER DATABASE [DAVISY] SET QUOTED_IDENTIFIER OFF 
GO
ALTER DATABASE [DAVISY] SET RECURSIVE_TRIGGERS OFF 
GO
ALTER DATABASE [DAVISY] SET  ENABLE_BROKER 
GO
ALTER DATABASE [DAVISY] SET AUTO_UPDATE_STATISTICS_ASYNC OFF 
GO
ALTER DATABASE [DAVISY] SET DATE_CORRELATION_OPTIMIZATION OFF 
GO
ALTER DATABASE [DAVISY] SET TRUSTWORTHY OFF 
GO
ALTER DATABASE [DAVISY] SET ALLOW_SNAPSHOT_ISOLATION OFF 
GO
ALTER DATABASE [DAVISY] SET PARAMETERIZATION SIMPLE 
GO
ALTER DATABASE [DAVISY] SET READ_COMMITTED_SNAPSHOT OFF 
GO
ALTER DATABASE [DAVISY] SET HONOR_BROKER_PRIORITY OFF 
GO
ALTER DATABASE [DAVISY] SET RECOVERY SIMPLE 
GO
ALTER DATABASE [DAVISY] SET  MULTI_USER 
GO
ALTER DATABASE [DAVISY] SET PAGE_VERIFY CHECKSUM  
GO
ALTER DATABASE [DAVISY] SET DB_CHAINING OFF 
GO
ALTER DATABASE [DAVISY] SET FILESTREAM( NON_TRANSACTED_ACCESS = OFF ) 
GO
ALTER DATABASE [DAVISY] SET TARGET_RECOVERY_TIME = 60 SECONDS 
GO
ALTER DATABASE [DAVISY] SET DELAYED_DURABILITY = DISABLED 
GO
ALTER DATABASE [DAVISY] SET ACCELERATED_DATABASE_RECOVERY = OFF  
GO
ALTER DATABASE [DAVISY] SET QUERY_STORE = OFF
GO
USE [DAVISY]
GO
/****** Object:  Table [dbo].[CHITIETHOADON]    Script Date: 11/18/2022 8:52:05 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CHITIETHOADON](
	[MACTHD] [nvarchar](10) NOT NULL,
	[MAHD] [nvarchar](10) NOT NULL,
	[MASP] [nvarchar](10) NOT NULL,
	[MAHANG] [nvarchar](10) NOT NULL,
	[MALH] [nvarchar](10) NOT NULL,
	[NGAYLAP] [date] NOT NULL,
	[TENSP] [nvarchar](50) NOT NULL,
	[TENHANG] [nvarchar](50) NOT NULL,
	[TENLH] [nvarchar](50) NOT NULL,
	[NGAYNHAP] [date] NOT NULL,
	[GIANHAP] [float] NOT NULL,
	[GIABAN] [float] NOT NULL,
	[SOLUONG] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[MACTHD] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[CHUCVU]    Script Date: 11/18/2022 8:52:05 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CHUCVU](
	[MACV] [int] NOT NULL,
	[TENCV] [nvarchar](50) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[MACV] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[GIOHANG]    Script Date: 11/18/2022 8:52:05 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[GIOHANG](
	[MAGH] [nvarchar](10) NOT NULL,
	[MAKH] [nvarchar](10) NOT NULL,
	[TENDN] [nvarchar](50) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[MAGH] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[GIOHANGTAM]    Script Date: 11/18/2022 8:52:05 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[GIOHANGTAM](
	[MAGH] [nvarchar](10) NOT NULL,
	[MASP] [nvarchar](10) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[HANG]    Script Date: 11/18/2022 8:52:05 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[HANG](
	[MAHANG] [nvarchar](10) NOT NULL,
	[TEHANG] [nvarchar](50) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[MAHANG] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[HOADON]    Script Date: 11/18/2022 8:52:05 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[HOADON](
	[MAHD] [nvarchar](10) NOT NULL,
	[TENDN] [nvarchar](50) NOT NULL,
	[MAKH] [nvarchar](10) NOT NULL,
	[MAGH] [nvarchar](10) NOT NULL,
	[NGAYLAP] [date] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[MAHD] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[KHACHHANG]    Script Date: 11/18/2022 8:52:05 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[KHACHHANG](
	[MAKH] [nvarchar](10) NOT NULL,
	[HOTEN] [nvarchar](50) NOT NULL,
	[DIENTHOAI] [nvarchar](20) NOT NULL,
	[DIACHI] [nvarchar](50) NOT NULL,
	[TICHDIEM] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[MAKH] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[LOAIHANG]    Script Date: 11/18/2022 8:52:05 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[LOAIHANG](
	[MALH] [nvarchar](10) NOT NULL,
	[TENLH] [nvarchar](50) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[MALH] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[SANPHAM]    Script Date: 11/18/2022 8:52:05 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[SANPHAM](
	[MASP] [nvarchar](10) NOT NULL,
	[TENSP] [nvarchar](50) NOT NULL,
	[MALH] [nvarchar](10) NOT NULL,
	[MAHANG] [nvarchar](10) NOT NULL,
	[GIANHAP] [float] NOT NULL,
	[GIABAN] [float] NOT NULL,
	[NGAYNHAP] [date] NOT NULL,
	[HINH] [nvarchar](50) NOT NULL,
	[MOTA] [nvarchar](100) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[MASP] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[TAIKHOAN]    Script Date: 11/18/2022 8:52:05 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TAIKHOAN](
	[TENDN] [nvarchar](50) NOT NULL,
	[MACV] [int] NOT NULL,
	[TENNV] [nvarchar](50) NOT NULL,
	[EMAIL] [nvarchar](50) NOT NULL,
	[MATKHAU] [nvarchar](50) NOT NULL,
	[DIACHI] [nvarchar](50) NOT NULL,
	[DIENTHOAI] [nvarchar](50) NOT NULL,
	[NGAYSINH] [date] NOT NULL,
	[GIOITINH] [bit] NOT NULL,
	[TRANGTHAI] [bit] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[TENDN] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
ALTER TABLE [dbo].[CHITIETHOADON]  WITH CHECK ADD  CONSTRAINT [FK_CTHD_SANPHAM] FOREIGN KEY([MASP])
REFERENCES [dbo].[SANPHAM] ([MASP])
GO
ALTER TABLE [dbo].[CHITIETHOADON] CHECK CONSTRAINT [FK_CTHD_SANPHAM]
GO
ALTER TABLE [dbo].[CHITIETHOADON]  WITH CHECK ADD  CONSTRAINT [FK_HOADON_CHITIETHOADON] FOREIGN KEY([MAHD])
REFERENCES [dbo].[HOADON] ([MAHD])
GO
ALTER TABLE [dbo].[CHITIETHOADON] CHECK CONSTRAINT [FK_HOADON_CHITIETHOADON]
GO
ALTER TABLE [dbo].[GIOHANG]  WITH CHECK ADD  CONSTRAINT [FK_GIOHANG_KHACHHANG] FOREIGN KEY([MAKH])
REFERENCES [dbo].[KHACHHANG] ([MAKH])
GO
ALTER TABLE [dbo].[GIOHANG] CHECK CONSTRAINT [FK_GIOHANG_KHACHHANG]
GO
ALTER TABLE [dbo].[GIOHANG]  WITH CHECK ADD  CONSTRAINT [FK_GIOHANG_TAIKHOAN] FOREIGN KEY([TENDN])
REFERENCES [dbo].[TAIKHOAN] ([TENDN])
GO
ALTER TABLE [dbo].[GIOHANG] CHECK CONSTRAINT [FK_GIOHANG_TAIKHOAN]
GO
ALTER TABLE [dbo].[GIOHANGTAM]  WITH CHECK ADD  CONSTRAINT [FK_GIOHANG_GIOHANG] FOREIGN KEY([MAGH])
REFERENCES [dbo].[GIOHANG] ([MAGH])
GO
ALTER TABLE [dbo].[GIOHANGTAM] CHECK CONSTRAINT [FK_GIOHANG_GIOHANG]
GO
ALTER TABLE [dbo].[GIOHANGTAM]  WITH CHECK ADD  CONSTRAINT [FK_GIOHANG_SANPHAM] FOREIGN KEY([MASP])
REFERENCES [dbo].[SANPHAM] ([MASP])
GO
ALTER TABLE [dbo].[GIOHANGTAM] CHECK CONSTRAINT [FK_GIOHANG_SANPHAM]
GO
ALTER TABLE [dbo].[HOADON]  WITH CHECK ADD  CONSTRAINT [FK_HOADON_GIOHANG] FOREIGN KEY([MAGH])
REFERENCES [dbo].[GIOHANG] ([MAGH])
GO
ALTER TABLE [dbo].[HOADON] CHECK CONSTRAINT [FK_HOADON_GIOHANG]
GO
ALTER TABLE [dbo].[HOADON]  WITH CHECK ADD  CONSTRAINT [FK_HOADON_KHACHHANG] FOREIGN KEY([MAKH])
REFERENCES [dbo].[KHACHHANG] ([MAKH])
GO
ALTER TABLE [dbo].[HOADON] CHECK CONSTRAINT [FK_HOADON_KHACHHANG]
GO
ALTER TABLE [dbo].[HOADON]  WITH CHECK ADD  CONSTRAINT [FK_HOADON_TAIKHOAN] FOREIGN KEY([TENDN])
REFERENCES [dbo].[TAIKHOAN] ([TENDN])
GO
ALTER TABLE [dbo].[HOADON] CHECK CONSTRAINT [FK_HOADON_TAIKHOAN]
GO
ALTER TABLE [dbo].[SANPHAM]  WITH CHECK ADD  CONSTRAINT [FK_SANPHAM_HANG] FOREIGN KEY([MAHANG])
REFERENCES [dbo].[HANG] ([MAHANG])
GO
ALTER TABLE [dbo].[SANPHAM] CHECK CONSTRAINT [FK_SANPHAM_HANG]
GO
ALTER TABLE [dbo].[SANPHAM]  WITH CHECK ADD  CONSTRAINT [FK_SANPHAM_LOAIHANG] FOREIGN KEY([MALH])
REFERENCES [dbo].[LOAIHANG] ([MALH])
GO
ALTER TABLE [dbo].[SANPHAM] CHECK CONSTRAINT [FK_SANPHAM_LOAIHANG]
GO
ALTER TABLE [dbo].[TAIKHOAN]  WITH CHECK ADD  CONSTRAINT [FK_TAIKHOAN_CHUCVU] FOREIGN KEY([MACV])
REFERENCES [dbo].[CHUCVU] ([MACV])
GO
ALTER TABLE [dbo].[TAIKHOAN] CHECK CONSTRAINT [FK_TAIKHOAN_CHUCVU]
GO
USE [master]
GO
ALTER DATABASE [DAVISY] SET  READ_WRITE 
GO
SELECT *from loaiha

INSERT INTO LOAIHANG VALUES
	(N'TN', N'Tai nghe'),
	(N'CSDP', N'Cục sạc dự phòng'),
	(N'BP', N'Bàn phím'),
	(N'LC', N'Lót chuột'),
	(N'GDLT', N'Giá đỡ laptop')

INSERT INTO HANG VALUES 
	(N'SS', N'SAMSUNG'),
	(N'SN', N'SONY'),
	(N'AP', N'APPLE'),
	(N'TSB', N'TOSHIBA'),
	(N'RZ', N'RAZER')


INSERT INTO SANPHAM VALUES
	(N'SP01', N'Tai nghe AirPod siêu cấp vip pro', N'TN', N'AP', 1000000, 1200000, CAST('7-10-2022' AS DATE), 'TN.PNG', ''),
	(N'SP02', N'Cục sạc dự phòng siêu cấp vip pro Sony', N'CSDP', N'SN', 300000, 400000, CAST('7-11-2020' AS DATE), 'TN.PNG', ''),
	(N'SP03', N'Bàn phím siêu cấp vip pro RAZER', N'BP', N'RZ', 800000, 1000000, CAST('12-1-2020' AS DATE), 'TN.PNG', ''),
	(N'SP04', N'Lót chuột siêu cấp vip pro in hình idol Đạt Villa', N'LC', N'TSB', 30000, 50000, CAST('7-7-2022' AS DATE), 'TN.PNG', ''),
	(N'SP05', N'Giá đỡ laptop siêu cấp vip pro bằng sứ', N'GDLT', N'SN', 500000, 600000, CAST('10-11-2022' AS DATE), 'TN.PNG', '')

INSERT INTO CHUCVU VALUES 
	(0, N'Quản lí'),
	(1, N'Nhân viên')


INSERT INTO TAIKHOAN VALUES
	(N'DangTH', 0, N'Trần Hữu Đang', 'dangthpc04349@gmail.com', '123', 'Vĩnh Long', '0123654987', CAST('7-9-2003' AS DATE), 1, 0),
	(N'VinhPQ', 1, N'Phùng Quốc Vinh', 'vinhpqpc04338@gmail.com', '123', 'Cần Thơ', '0123654987', CAST('5-11-2002' AS DATE), 1, 0),
	(N'DanNK', 1, N'Nguyễn Khánh Đan', 'dannkpc04351@gmail.com', '123', 'Cần Thơ', '0123654987', CAST('7-11-2022' AS DATE), 0, 1),
	(N'SyDH', 1, N'Đoàn Hiệp Sỹ', 'sydhpc04388@gmail.com', '123', 'An Giang', '0123654987', CAST('7-4-2003' AS DATE), 1, 0),
	(N'ViLB', 1, N'Lê Bích Vi', 'vilbpc04354@gmail.com', '123', 'Cà Mau', '0123654987', CAST('2-6-2003' AS DATE), 0, 1)
	
INSERT INTO KHACHHANG VALUES
	(N'DarkTH', N'Trần Hũ Dark', '0123456789', 'Vĩnh Long', 0),
	(N'DinhPQ', N'Phùng Quắk Dinh', '0123456789', 'Cần Thơ', 0),
	(N'DenNK', N'Nguyễn Khánk Đen', '0123456789', 'Cần Thơ', 0),
	(N'PeppaD', N'Đoàn Peppa', '0123456789', 'An Giang', 0),
	(N'DeLB', N'Lê Bíck De', '0123456789', 'Cà Mau', 0)

INSERT INTO GIOHANG VALUES 
	(N'GH01', N'DarkTH', N'VinhPQ'),
	(N'GH02', N'DinhPQ', N'VinhPQ'),
	(N'GH03', N'DenNK', N'DanNK'),
	(N'GH04', N'PeppaD', N'DanNK'),
	(N'GH05', N'DeLB', N'SyDH')

INSERT INTO GIOHANGTAM VALUES 
	(N'GH01', N'SP01'),
	(N'GH01', N'SP02'),
	(N'GH02', N'SP02'),
	(N'GH03', N'SP01'),
	(N'GH04', N'SP04'),
	(N'GH05', N'SP01')

INSERT INTO HOADON VALUES
	(N'HD01', N'VinhPQ', N'DarkTH', N'GH01', CAST('6-10-2022' AS DATE)),
	(N'HD02', N'VinhPQ', N'DinhPQ', N'GH02', CAST('7-11-2022' AS DATE)),
	(N'HD03', N'DanNK', N'DenNK', N'GH03', CAST('7-11-2022' AS DATE)),
	(N'HD04', N'DanNK', N'PeppaD', N'GH04', CAST('8-11-2022' AS DATE)),
	(N'HD05', N'SyDH', N'DeLB',N'GH05', CAST('9-11-2022' AS DATE))

-- SELECT * FROM CHITIETHOADON  
INSERT INTO CHITIETHOADON VALUES
	(N'CTHD01', N'HD01', N'SP01', 'AP', 'TN', CAST('6-10-2022' AS DATE), N'Tai nghe AirPod siêu cấp vip pro', 'APPLE', N'Tai nghe', CAST('7-10-2022' AS DATE), 1000000, 1200000, 1),
	(N'CTHD02', N'HD01', N'SP02', 'SN', 'CSDP', CAST('6-10-2022' AS DATE), N'Cục sạc dự phòng siêu cấp vip pro Sony', 'SONY', N'Cục sạc dự phòng', CAST('7-11-2022' AS DATE), 300000, 400000, 1),
	(N'CTHD03', N'HD02', N'SP02', 'SN', 'CSDP', CAST('7-11-2022' AS DATE), N'Cục sạc dự phòng siêu cấp vip pro Sony', 'SONY', N'Cục sạc dự phòng', CAST('7-11-2022' AS DATE), 300000, 400000, 1),
	(N'CTHD04', N'HD03', N'SP01', 'AP', 'TN', CAST('9-11-2022' AS DATE), N'Tai nghe AirPod siêu cấp vip pro', 'APPLE', N'Tai nghe', CAST('7-10-2022' AS DATE), 1000000, 1200000, 2),
	(N'CTHD05', N'HD04', N'SP04', 'LC', 'TSB', CAST('8-11-2022' AS DATE), N'Lót chuột siêu cấp vip pro in hình idol Đạt Villa', 'TOSHIBA', N'Lót chuột', CAST('7-10-2022' AS DATE), 30000, 40000, 1),
	(N'CTHD06', N'HD05', N'SP01', 'AP', 'TN', CAST('9-11-2022' AS DATE), N'Tai nghe AirPod siêu cấp vip pro', 'APPLE', N'Tai nghe', CAST('7-10-2022' AS DATE), 1000000, 1200000, 2)

/* SELECT * FROM SANPHAM
SELECT * FROM LOAIHANG
SELECT * FROM NHANVIEN
SELECT * FROM KHACHHANG
SELECT * FROM HOADON
SELECT * FROM GIOHANG
SELECT * FROM HOADONCHITIET */

-- DROP PROC sp_NHANVIENSX
CREATE PROC sp_NHANVIENSX
AS BEGIN
	SELECT 
		HD.TENDN,
		COUNT(HD.MAHD) SL
	FROM HOADON HD JOIN TAIKHOAN NV ON NV.TENDN = HD.TENDN
	WHERE NV.TENDN = HD.TENDN

	GROUP BY HD.TENDN
	ORDER BY SL DESC
END
GO

--EXEC sp_NHANVIENSX

--DROP PROC sp_ThongKeDoanhThu_NAM
/*CREATE PROC sp_ThongKeDoanhThu_NAM (@Day INT, @Month INT, @Year INT)
AS BEGIN
	SELECT
		HD.MAHD,
		HD.NGAYLAP,
		HD.TENDN,
		HD.THANHTIEN
	FROM HOADON HD
		WHERE YEAR(NGAYLAP) = @Year AND MONTH(NGAYLAP) = @Month AND DAY(NGAYLAP) = @Day
END
GO

EXEC sp_ThongKeDoanhThu_NAM  '11', '7', '2022'
*/


--DROP PROC sp_ThongKeDoanhThu_SP
/*CREATE PROC sp_ThongKeDoanhThu_SP
AS BEGIN
	SELECT
		SP.MASP,
		SP.TENSP,
		COUNT(HD.MAHD) LUOTBAN
	FROM HOADON HD
	JOIN CHITIETHOADON CTHD ON HD.MAHD = CTHD.MAHD
	JOIN SANPHAM SP ON SP.MASP = CTHD.MASP
		WHERE HD.MAHD = CTHD.MAHD AND SP.MASP = CTHD.MASP
		GROUP BY SP.MASP, SP.TENSP
		ORDER BY LUOTBAN DESC
END
GO

--EXEC sp_ThongKeDoanhThu_SP
*/
